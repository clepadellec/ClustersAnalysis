for (i in 1:length(others_var)){
res[i,1]<-name_var_group
res[i,2]<-others_var[i]
res[i,3]<-chisq.test(data[name_var_group][,1],data[others_var[i]][,1])$p.value
if (res[i,3]<0.05){
res[i,4]<-"significatif"
}else{
res[i,4]<-"non significatif"
}
}
return(res)
}
chisq_test_all("Continent",Data.qual)
x <- 2.20730600331155e-58
print(round(x,4))
print(round(x,5))
chisq_test_all <- function(name_var_group,data){
options(warn=-1)
others_var <- colnames(data)[colnames(data)!=name_var_group]
res <- matrix(data = NA, nrow = length(others_var), ncol = 4)
for (i in 1:length(others_var)){
res[i,1]<-name_var_group
res[i,2]<-others_var[i]
res[i,3]<-chisq.test(data[name_var_group][,1],data[others_var[i]][,1])$p.value
if (round(res[i,3],5)<0.05){
res[i,4]<-"significatif"
}else{
res[i,4]<-"non significatif"
}
}
return(res)
}
chisq_test_all("Continent",Data.qual)
chisq_test_all <- function(name_var_group,data){
options(warn=-1)
others_var <- colnames(data)[colnames(data)!=name_var_group]
res <- matrix(data = NA, nrow = length(others_var), ncol = 4)
for (i in 1:length(others_var)){
res[i,1]<-name_var_group
res[i,2]<-others_var[i]
res[i,3]<-as.numeric(chisq.test(data[name_var_group][,1],data[others_var[i]][,1])$p.value)
if (round(res[i,3],5)<0.05){
res[i,4]<-"significatif"
}else{
res[i,4]<-"non significatif"
}
}
return(res)
}
chisq_test_all("Continent",Data.qual)
chisq_test_all <- function(name_var_group,data){
options(warn=-1)
others_var <- colnames(data)[colnames(data)!=name_var_group]
res <- matrix(data = NA, nrow = length(others_var), ncol = 4)
for (i in 1:length(others_var)){
res[i,1]<-name_var_group
res[i,2]<-others_var[i]
res[i,3]<-chisq.test(data[name_var_group][,1],data[others_var[i]][,1])$p.value
if (round(as.numeric(res[i,3]),5)<0.05){
res[i,4]<-"significatif"
}else{
res[i,4]<-"non significatif"
}
}
return(res)
}
chisq_test_all("Continent",Data.qual)
chisq_test_all <- function(name_var_group,data){
options(warn=-1)
others_var <- colnames(data)[colnames(data)!=name_var_group]
res <- matrix(data = NA, nrow = length(others_var), ncol = 4)
for (i in 1:length(others_var)){
res[i,1]<-name_var_group
res[i,2]<-others_var[i]
res[i,3]<-chisq.test(data[name_var_group][,1],data[others_var[i]][,1])$p.value
if (round(as.numeric(res[i,3]),5)<0.05){
res[i,4]<-"significatif"
}else{
res[i,4]<-"non significatif"
}
}
res <- as.data.frame(res)
colnames(res)<-c("var.groupement","var.explicative","p.value.chisq.test","interpretation")
return(res)
}
chisq_test_all("Continent",Data.qual)
library(ClustersAnalysis)
data=read.csv2("Données-R-1.csv", sep=";", row.names = 1)
Data.qual<- ClustersAnalysis::extract_ql(data)
print(Data.qual)
ClustersAnalysis::chisq_test_all("Continent",Data.qual)
ClustersAnalysis::chisq_test_all("Region",Data.qual)
ClustersAnalysis::chisq_test_all("index_quali",Data.qual)
knitr::opts_chunk$set(echo = TRUE, message=FALSE, warnings=FALSE)
#setwd('C:/Users/clementlepadellec/Downloads/')
data_0=read.csv2("Données-R-1.csv", sep=";", row.names = 1)
data.qt = data_0[,1:10]
#aper?u des donn?es
print(summary(data_0))
#premier regard sur la corr?lation
cor(data.qt)
plot(data.qt)
#Au premier abord les variables corr?l?es avec l'index semblent ?tre :
#positivement : esperance, bien ?tre, heureux
#n?gativement : ineg_rev
#r?partition des donn?es par variables / 1er regard sur certains individus atypiques
#indicateurs
boxplot(data.qt[,1:8])
# a part pour la variable empreinte il ne semble pas y avoir d'individu atypique
#PIB
boxplot(data.qt[,9])
#On remarque quue certains individus ont un PIB nettement sup?rieur ? la moyenne
#Population
boxplot(data.qt[,10])
#Sur ce graphique il semble y avoir 2 pays qui ont une populations nettement sup?rieur aux autres pays
#On sait dor?navant que pour certaines variables, les individus peuvent avoir des valeurs ab?rrentes, il faudra se m?fier ? ce que cel? n'impacte pas nos analyses
data = data_0[c(8,14:16,18)]
#var 8= index qui passera en quanti sup
#autres vars = R?gion, R?gime politique et libert? sur internet
data = data_0[c(8,14:16,18)]
print(data)
#var 8= index qui passera en quanti sup
#autres vars = R?gion, R?gime politique et libert? sur internet
library(factoextra)
library(FactoMineR)
# Analyse correspondances multiples (ACM)
res.mca <- MCA (data, quanti.sup = 1, graph = TRUE)  #calcul de l'ACM, resultats mis dans une variable
print(res.mca) #Variable resultat contient tous les elements suivants
#p-s valeurs propres avec s = nb de variables
#ici 15 (13-4)
#Visualisation des valeurs propres
eig.val <- get_eigenvalue(res.mca)
eig.val
fviz_eig(res.mca, addlabels = TRUE, ylim = c(0, 50)) #graphique des valeurs propres avec la fonction fviz_eig() ou fviz_screeplot() du package factoextra
#avec coude on garde 1 axe, (1/9 = 0.111 donc 11%), donc il devrait avoir 11 sur chaque axe, dans le 1 on en retrouve 28
#donc c'est beaucoup plus, donc il est bien repr?sentatif
#pour l'axe 2, par rapport ? moyenne, il est au dessus
knitr::opts_chunk$set(echo = TRUE, message=FALSE, warnings=FALSE)
library("fpc")
#Chargement des packages n?cessaires
install.packages(c("FactoMineR", "factoextra", "questionr","xlsx","fpc","corrplot","ExPosition" ),repos = "http://cran.us.r-project.org")
library("fpc")
library("FactoMineR")
library("factoextra")
library("questionr")
library("corrplot")
library("ExPosition")
#setwd('C:/Users/clementlepadellec/Downloads/')
data_0=read.csv2("Données-R-1.csv", sep=";", row.names = 1)
data.qt = data_0[,1:10]
#aper?u des donn?es
print(summary(data_0))
#premier regard sur la corr?lation
cor(data.qt)
plot(data.qt)
#Au premier abord les variables corr?l?es avec l'index semblent ?tre :
#positivement : esperance, bien ?tre, heureux
#n?gativement : ineg_rev
#r?partition des donn?es par variables / 1er regard sur certains individus atypiques
#indicateurs
boxplot(data.qt[,1:8])
# a part pour la variable empreinte il ne semble pas y avoir d'individu atypique
#PIB
boxplot(data.qt[,9])
#On remarque quue certains individus ont un PIB nettement sup?rieur ? la moyenne
#Population
boxplot(data.qt[,10])
#Sur ce graphique il semble y avoir 2 pays qui ont une populations nettement sup?rieur aux autres pays
#On sait dor?navant que pour certaines variables, les individus peuvent avoir des valeurs ab?rrentes, il faudra se m?fier ? ce que cel? n'impacte pas nos analyses
data.active = data_0[,c('Esperance', 'Bien.Etre', 'Heureux', 'Empreinte','Ineg_rev','Ineg_BE', 'Ineg_esp', 'PIB','Population')]
head(data.active)
#mise en place de l'acp avec l'option pour centrer r?duire les donn?es
res.pca <- PCA(data.active, scale.unit = TRUE, ncp = 3, graph = T)
print(res.pca)
# graphique ?cras? car 2 individus contribuent tr?s fortement ? la construction de l'axe 2
eig.val <- get_eigenvalue(res.pca)
eig.val
fviz_eig(res.pca, addlabels = TRUE, ylim = c(0, 50))
var <- get_pca_var(res.pca)
var
#-> Graphique du Cos2 des variables sur le 1 premier axe :
fviz_cos2(res.pca, choice = "var")
var$coord
var$cos2
var$contrib
coord <- var$coord[,1]
contrib <- var$contrib[,1]
cos2 <- var$cos2[,1]
display <- cbind(coord,contrib,cos2)
display
#L'axe 1 met en ?vidence du cot? positif les pays qui sont bien not?es en heureux et mal not? en ineg_rev, et du cot? n?gatif, les pays bien not?s en Ineg_rev et mal not? en heureux
coord <- var$coord[,1]
contrib <- var$contrib[,1]
cos2 <- var$cos2[,1]
display <- cbind(coord,contrib,cos2)
display
#L'axe 1 met en ?vidence du cot? positif les pays qui sont bien not?es en heureux et mal not? en ineg_rev, et du cot? n?gatif, les pays bien not?s en Ineg_rev et mal not? en heureux
coord <- var$coord[,2]
contrib <- var$contrib[,2]
cos2 <- var$cos2[,2]
display <- cbind(coord,contrib,cos2)
display
#contribution des individus aux dim 1 et dim 2
fviz_contrib(res.pca, choice = "ind", axes = 1,top = 10)
fviz_contrib(res.pca, choice = "ind", axes = 1:2, top = 10)
fviz_pca_biplot(res.pca, repel = TRUE,
col.var = "#2E9FDF", # Couleur des variables
addEllipses = TRUE, col.ind = "#696969" # Couleur des individues
)
res.pca2 <- PCA(data.active, ind.sup = NULL,
quanti.sup = 8:9, graph=TRUE)
eig.val <- get_eigenvalue(res.pca2)
eig.val
fviz_eig(res.pca, addlabels = TRUE, ylim = c(0, 50))
fviz_pca_biplot(res.pca2, repel = TRUE,
col.var = "#2E9FDF", # Couleur des variables
addEllipses = TRUE, col.ind = "#696969" # Couleur des individus
)
fviz_contrib(res.pca2, choice = "ind", axes = 1:2, top = 10)
fviz_contrib(res.pca2, choice = "ind", axes = 1,top = 10)
View(data_0)
#transformation de la variable quanti "Heureux" en une variable qualitative
data_0$heureux_quali <- cut(data_0$Heureux, breaks = 4, include.lowest = TRUE, labels = c("heureux.1", "heureux.2", "heureux.3", "heureux.4"))
data_0$heureux_quali <- cut(data_0$Heureux, breaks = 4, include.lowest = TRUE,
labels = c("heureux.1", "heureux.2", "heureux.3", "heureux.4"))
data = data_0
var_quali = Heureux
var_quali = 'Heureux'
cutting = 4
recod <- paste0(var_quali,'_quali2')
recod
liste_labels <- []
for (i in 1:cutting){
liste_labels[i] <- paste0(var_quali,'.',i)
}
liste_labels <- NA
for (i in 1:cutting){
liste_labels[i] <- paste0(var_quali,'.',i)
}
liste_labels
data$recod <- cut(data$var_quali, breaks = cutting, include.lowest = TRUE, labels = liste_labels)
data$var_quali
typeof(data$var_quali)
typeof(data$Heureux)
data$recod <- cut(data$Heureux, breaks = cutting, include.lowest = TRUE, labels = liste_labels)
data$recod
typeof(recod)
typeof(var_quali)
var_quali <- paste0(var_quali)
data$var_quali
View(data)
var_quanti = 'Heureux'
data = data_0
data$var_quanti
which(colnames(data) == var_quanti)
data = data_0
var_quanti = 'Heureux'
cutting = 4
index <- which(colnames(data) == var_quanti)
index
recod <- paste0(var_quanti,'_quali2')
liste_labels <- NA
for (i in 1:cutting){
liste_labels[i] <- paste0(var_quanti,'.',i)
}
data$recod <- cut(data[$var_quanti[index], breaks = cutting, include.lowest = TRUE, labels = liste_labels)
}
data = data_0
var_quanti = 'Heureux'
cutting = 4
data_0$heureux_quali <- cut(data_0$Heureux, breaks = 4, include.lowest = TRUE,
labels = c("heureux.1", "heureux.2", "heureux.3", "heureux.4"))
data = data_0
var_quanti = 'Heureux'
index <- which(colnames(data) == var_quanti)
recod <- paste0(var_quanti,'_quali2')
liste_labels <- NA
for (i in 1:cutting){
liste_labels[i] <- paste0(var_quanti,'.',i)
}
data$recod <- cut(data[$var_quanti[index], breaks = cutting, include.lowest = TRUE, labels = liste_labels)
}
data = data_0
var_quanti = 'Heureux'
cutting = 4
data_0$heureux_quali <- cut(data_0$Heureux, breaks = 4, include.lowest = TRUE,
labels = c("heureux.1", "heureux.2", "heureux.3", "heureux.4"))
data$recod <- cut(data[index], breaks = cutting, include.lowest = TRUE, labels = liste_labels)
data[index]
data[,index]
data$recod <- cut(data[,index], breaks = cutting, include.lowest = TRUE, labels = liste_labels)
View(data)
#affichage des fr?quence
freq(data_0$heureux_quali)
freq(data_0$heureux_quali)
data_0[-c(1:11)]
typeof(data[0])
typeof(colnames(data[0]))
View(data)
typeof(colnames(data[1]))
typeof(data[1,1])
#' Title
#'
#' @param data
#' @param var_quanti
#' @param cutting
#'
#' @return
#' @export
#'
#' @examples
recod_quanti <- function(data, var_quanti,cutting){
index <- which(colnames(data) == var_quanti)
recod <- paste0(var_quanti,'_quali2')
liste_labels <- NA
for (i in 1:cutting){
liste_labels[i] <- paste0(var_quanti,'.',i)
}
data$recod <- cut(data[,index], breaks = cutting, include.lowest = TRUE, labels = liste_labels)
return(data)
}
data1 <- recod_quanti(data_0, 'Heureux', 4)
View(data1)
colnames(data1$record) <- record
colnames(data1$recod) <- recod
colnames(data1$recod)
colnames(data1)
c(colnames(data1))
col <- colnames(data1)
col
data = data_0
for (i in 1:ncol(data)){
if (typeof(data[1,i]) == "double"){
data <- data[,-i]
}
}
View(data)
for (i in 1:ncol(data)){
ncol(data)
if (typeof(data[1,i]) == "double"){
data <- data[,-i]
}
}
data = data_0
for (i in 1:ncol(data)){
print(ncol(data))
if (typeof(data[1,i]) == "double"){
data <- data[,-i]
}
}
library(dplyr)
for (i in 1:ncol(data)){
print(ncol(data))
if (typeof(data[1,i]) == "double"){
data <- data %>% select(-i)
}
}
data = data_0
for (i in 1:ncol(data)){
print(ncol(data))
if (typeof(data[1,i]) == "double"){
data <- data %>% select(-i)
}
}
View(data)
data = data_0
data %>%
head %>%
collect %>%
lapply(class) %>%
unlist
a <- data %>%
head %>%
collect %>%
lapply(class) %>%
unlist
a == "numeric"
which(a == "numeric")
c(which(a == "numeric"))
b <- c(which(a == "numeric"))
typeof(b)
data[,-b]
which(a == "numeric" || a == "integer")
View(data_0)
c <- which(a == "integer")
data[,-c]
data = data_0
a <- data %>%
head %>%
collect %>%
lapply(class) %>%
unlist
which(a == "numeric")
b <- c(which(a == "numeric"))
data <- data[,-b]
c <- which(a == "integer")
data <- data[,-c]
View(data)
c <- c(which(a == "integer"))
data <- data[,-c]
data = data_0
a <- data %>%
head %>%
collect %>%
lapply(class) %>%
unlist
which(a == "numeric")
b <- c(which(a == "numeric"))
data <- data[,-b]
View(data)
c <- c(which(a == "integer"))
c
a <- data %>%
head %>%
collect %>%
lapply(class) %>%
unlist
c <- c(which(a == "integer"))
data <- data[,-c]
View(data)
data = data_0
# Repère var numeric
type_var <- data %>% head %>% collect %>% lapply(class) %>% unlist
which(type_var == "numeric" | type_var == "integer")
detection_quanti <- function(data){
# Repère var quanti
type_var <- data %>% head %>% collect %>% lapply(class) %>% unlist
# Repère index var quanti
var_quanti <- c(which(type_var == "numeric" | type_var == "integer"))
# Supprime var quanti
data <- data[,-var_quanti]
}
detection_quanti(data_0)
detection_quanti <- function(data){
# Repère var quanti
type_var <- data %>% head %>% collect %>% lapply(class) %>% unlist
# Repère index var quanti
var_quanti <- c(which(type_var == "numeric" | type_var == "integer"))
# Supprime var quanti
data <- data[,-var_quanti]
return(data)
}
detection_quanti(data_0)
#on supprime les variables quantitaives
data = data_0[-c(1:11)]
#on s'assure que tout est bien en cha?ne de caract?re
str(data)
names(data) #noms des variables restantes
data$liberte_internet<- factor(data$liberte_internet, levels = c("F", "PF","NF"))
#'
#' @param data
#' @param name_var_group the target variable (group variable)
#' @param name_var_comp the other qualitative variable
#'
#' @return contingence table, and profils
#' @export
#' @import questionr
#' @examples
#'#desc_profils(data,"heureux_quali","Region")
desc_profils <- function(data,name_var_group,name_var_comp){
contingence<-table(data[name_var_group][,1], data[name_var_comp][,1])
print("Tableau de contingence : ")
print(contingence)
print("Profils lignes : ")
print(lprop(contingence, digits=1))
print("Profils colonnes : ")
print(cprop(contingence, digits=2))
}
desc_profils(data$heureux_quali, data$Region)
recod <- paste0(var_quanti,'_quali2')
recod
data[record][,1]
data[record][,1] <- cut(data[,index], breaks = cutting, include.lowest = TRUE, labels = liste_labels)
data = data_0[c(8,14:16,18)]
data
View(data)
chisq_test_all <- function(name_var_group,data){
options(warn=-1)
others_var <- colnames(data)[colnames(data)!=name_var_group]
res <- matrix(data = NA, nrow = length(others_var), ncol = 4)
for (i in 1:length(others_var)){
res[i,1]<-name_var_group
res[i,2]<-others_var[i]
res[i,3]<-chisq.test(data[name_var_group][,1],data[others_var[i]][,1])$p.value
if (round(as.numeric(res[i,3]),5)<0.05){
res[i,4]<-"significatif"
}else{
res[i,4]<-"non significatif"
}
}
res <- as.data.frame(res)
colnames(res)<-c("var.groupement","var.explicative","p.value.chisq.test","interpretation")
return(res)
}
data=read.csv2("Données-R-1.csv", sep=";", row.names = 1)
Data.qual<- extract_ql(data)
#fonction "extract_ql"
#' Title
#'
#' @param data a dataframe
#'
#' @return the dataframe with only qualitative data
#' @export
#'
#' @examples
extract_ql <- function(data){
ind.qual <- sapply(data, function(x) is.factor(x)| is.character(x))
Data.qual <- data[ ,ind.qual]
return(Data.qual)
}
Data.qual<- extract_ql(data)
chisq_test_all("Continent",Data.qual)
