repel = TRUE
#Rzsultats pour les individus (= points lignes)
#
ind <- get_mca_ind (res.mca)
ind
ind$coord# Coordonnees des profils lignes
ind$cos2# Cos2: qualite de representation des profils lignes
ind$contrib# Contributions aux axes des profils lignes
#Visualisation des points lignes
fviz_mca_ind(res.mca, select.ind = list(cos2 = 80),col.ind = "contrib",
gradient.cols = c("#00AFBB", "#E7B800", "#FC4E07"),geom="point",
repel = TRUE
)
#du cot? + de l'axe 1 on retrouve Australie, Autriche, Belgique, Canada,etc
#du cot? - de l'axe 1 on retrouve Chine, Afghanistan, Turkemistan, Ethipi, etc
#ces deux groupes de pays ne seront pas not? de la m?me facon
#Rzsultats pour les individus (= points lignes)
#
ind <- get_mca_ind (res.mca)
ind
ind$coord# Coordonnees des profils lignes
ind$cos2# Cos2: qualite de representation des profils lignes
ind$contrib# Contributions aux axes des profils lignes
#Visualisation des points lignes
fviz_mca_ind(res.mca, select.ind = list(cos2 = 80),col.ind = "contrib",
gradient.cols = c("#00AFBB", "#E7B800", "#FC4E07"),geom="text",
repel = TRUE
)
#du cot? + de l'axe 1 on retrouve Australie, Autriche, Belgique, Canada,etc
#du cot? - de l'axe 1 on retrouve Chine, Afghanistan, Turkemistan, Ethipi, etc
#ces deux groupes de pays ne seront pas not? de la m?me facon
#Rzsultats pour les individus (= points lignes)
#
ind <- get_mca_ind (res.mca)
ind
ind$coord# Coordonnees des profils lignes
ind$cos2# Cos2: qualite de representation des profils lignes
ind$contrib# Contributions aux axes des profils lignes
#Visualisation des points lignes
fviz_mca_ind(res.mca[1,2], select.ind = list(cos2 = 80),col.ind = "contrib",
gradient.cols = c("#00AFBB", "#E7B800", "#FC4E07"),geom="text",
repel = TRUE
)
#Rzsultats pour les individus (= points lignes)
#
ind <- get_mca_ind (res.mca)
ind
#ind$coord# Coordonnees des profils lignes
#ind$cos2# Cos2: qualite de representation des profils lignes
#ind$contrib# Contributions aux axes des profils lignes
#Visualisation des points lignes
fviz_mca_ind(res.mca[1,2], select.ind = list(cos2 = 80),col.ind = "contrib",
gradient.cols = c("#00AFBB", "#E7B800", "#FC4E07"),geom="text",
repel = TRUE
)
#ind$cos2# Cos2: qualite de representation des profils lignes
#ind$contrib# Contributions aux axes des profils lignes
#Visualisation des points lignes
fviz_mca_ind(res.mca[1:2,], select.ind = list(cos2 = 80),col.ind = "contrib",
gradient.cols = c("#00AFBB", "#E7B800", "#FC4E07"),geom="text",
repel = TRUE
)
#ind$cos2# Cos2: qualite de representation des profils lignes
#ind$contrib# Contributions aux axes des profils lignes
#Visualisation des points lignes
fviz_mca_ind(res.mca, select.ind = list(cos2 = 80),col.ind = "contrib",
gradient.cols = c("#00AFBB", "#E7B800", "#FC4E07"),axes=c(3,4),geom="text",
repel = TRUE
)
v1 <- factor(round(runif(500,1,4)))
v2 <- factor(round(runif(500,1,3)))
tab <- table(v1,v2)
print(tab)
cramer.v(tab)
chisq_test_all <- function(name_var_group,data){
options(warn=-1)
others_var <- colnames(data)[colnames(data)!=name_var_group]
res <- matrix(data = NA, nrow = length(others_var), ncol = 5)
for (i in 1:length(others_var)){
res[i,1]<-name_var_group
res[i,2]<-others_var[i]
res[i,3]<-chisq.test(data[name_var_group][,1],data[others_var[i]][,1])$p.value
if (round(as.numeric(res[i,3]),5)<0.05){
res[i,4]<-"significatif"
t<- table(data[name_var_group][,1],data[others_var[i]][,1])
v<- cramer.v(t)
res[i,5]<-v
}else{
res[i,4]<-"non significatif"
res[i,5]<-NA
}
}
res <- as.data.frame(res)
colnames(res)<-c("var.groupement","var.explicative","p.value.chisq.test","interpretation","intensité(v cramer)")
return(res)
}
Data=read.csv2("Données-R-1.csv", sep=";", row.names = 1)
Data.qual<- extract_ql(data)
library(ClustersAnalysis)
Data=read.csv2("Données-R-1.csv", sep=";", row.names = 1)
Data.qual<- extract_ql(data)
chisq_test_all("Continent",Data.qual)
View(Data.qual)
View(Data)
View(Data.qual)
Data=read.csv2("Données-R-1.csv", sep=";", row.names = 1)
Data.qual<- extract_ql(data)
View(Data)
chisq_test_all("liberte_internet",Data.qual)
chisq_test_all("liberte_internet",Data.qual)
chisq_test_all("Régim_simp",Data.qual)
chisq_test_all("Régime_simp",Data.qual)
library(ClustersAnalysis)
knitr::opts_chunk$set(echo = TRUE, message=FALSE, warnings=FALSE)
library("fpc")
library("FactoMineR")
library("factoextra")
library("questionr")
library("corrplot")
library("ExPosition")
#setwd('C:/Users/clementlepadellec/Downloads/')
data_0=read.csv2("Données-R-1.csv", sep=";", row.names = 1)
data = data_0[c(8,14:16,18)]
#rownames(data)<-NULL
print(data)
#var 8= index qui passera en quanti sup
#autres vars = R?gion, R?gime politique et libert? sur internet
# Analyse correspondances multiples (ACM)
res.mca <- MCA (data, quanti.sup = 1, graph = TRUE)  #calcul de l'ACM, resultats mis dans une variable
print(res.mca) #Variable resultat contient tous les elements suivants
#p-s valeurs propres avec s = nb de variables
#ici 15 (13-4)
#Visualisation des valeurs propres
eig.val <- get_eigenvalue(res.mca)
eig.val
fviz_eig(res.mca, addlabels = TRUE, ylim = c(0, 50)) #graphique des valeurs propres avec la fonction fviz_eig() ou fviz_screeplot() du package factoextra
#avec coude on garde 1 axe, (1/9 = 0.111 donc 11%), donc il devrait avoir 11 sur chaque axe, dans le 1 on en retrouve 28
#donc c'est beaucoup plus, donc il est bien repr?sentatif
#pour l'axe 2, par rapport ? moyenne, il est au dessus
#Rzsultats pour les individus (= points lignes)
#
ind <- get_mca_ind (res.mca)
ind
#ind$coord# Coordonnees des profils lignes
#ind$cos2# Cos2: qualite de representation des profils lignes
#ind$contrib# Contributions aux axes des profils lignes
#Visualisation des points lignes
fviz_mca_ind(res.mca, select.ind = list(cos2 = 80),col.ind = "contrib",
gradient.cols = c("#00AFBB", "#E7B800", "#FC4E07"),axes=c(3,4),geom="text",
repel = TRUE
)
#du cot? + de l'axe 1 on retrouve Australie, Autriche, Belgique, Canada,etc
#du cot? - de l'axe 1 on retrouve Chine, Afghanistan, Turkemistan, Ethipi, etc
#ces deux groupes de pays ne seront pas not? de la m?me facon
#Resultats pour les modalites (=points colonnes)
#
var <- get_mca_var(res.mca)
var
head(var$coord)# Coordonnees des points colonnes
head(var$cos2)# Cos2: qualite de representation des points colonnes
head(var$contrib)# Contributions aux axes des points colonnes
fviz_mca_var (res.mca, choice = "mca.cor", repel = TRUE) #Visualisation de la correlation des variables avec les axes
corrplot(var$cos2, is.corr=FALSE)# graphique du Cos2 des points colonnes sur tous les axes
fviz_cos2(res.mca, choice = "var")# graphique du Cos2 des points colonnes sur le 1er axe
corrplot(var$contrib, is.corr=FALSE)# graphique de la contributions des points colonnes sur tous les axes
fviz_contrib(res.mca, choice = "var")# graphique de la contribution des points colonnes sur le 1er axe
#Description des dimensions et mise en evidence des points qui contribuent le plus aux axes
# Description de la dimension
res.desc <- dimdesc(res.mca, axes = c(1, 2))#fonction dimdesc() [dans FactoMineR]
res.desc[[1]]
res.desc[[2]]
var
coord = var$coord[,1]
contrib = var$contrib[,1]
cos2 = var$cos2[,1]
display = cbind(coord, contrib, cos2)
display
#du cot? + de l'axe 1 on retrouve l'acc?s ? internet ? plus de 75% de la population, ?tre libre sur internet, plus de 15 ans d'?tude, ?tre une monarchie
#du cot? + de l'axe 1 on retrouve l'acc?s ? internet ? moins de 25% de la population, moins de 10 ans d'?tude, ?tre une dictature
# Biplot des lignes et colonnes
fviz_mca_biplot(res.mca, select.ind = list(cos2 = 75),
repel = TRUE
)
#'
#' @param df
#' @param dims
#' @param name_ind
#'
#' @return
#' @export
#'
#' @examples
#'
acm_plot <- function(df,dims,name_ind=NULL){
s
séms
és
sé
ms
x)
#'
#' @param df
#' @param dims
#' @param name_ind
#'
#' @return
#' @export
#'
#' @examples
#'
acm_plot <- function(df,dims,name_ind=NULL){
if (name_ind != NULL){
rownames(df)=name_ind
}
res.mca <- MCA (df, graph = TRUE)
ind <- get_mca_ind (res.mca)
if (name_ind != NULL){
fviz_mca_ind(res.mca, select.ind = list(cos2 = 80),col.ind = "contrib",
gradient.cols = c("#00AFBB", "#E7B800", "#FC4E07"),axes=dims,geom="text",
repel = TRUE)
}else{
fviz_mca_ind(res.mca, select.ind = list(cos2 = 80),col.ind = "contrib",
gradient.cols = c("#00AFBB", "#E7B800", "#FC4E07"),axes=dims,geom="point",
repel = TRUE)
}
var <- get_mca_var(res.mca)
corrplot(var$cos2, is.corr=FALSE)
fviz_mca_biplot(res.mca, select.ind = list(cos2 = 75),axes=dims,
repel = TRUE)
}
data = data_0[c(8,14:16,18)]
d=c(1,2)
acm_plot(data,d)
#'
#' @param df
#' @param dims
#' @param name_ind
#'
#' @return
#' @export
#'
#' @examples
#'
acm_plot <- function(df,dims,name_ind=0){
if (name_ind != 0){
rownames(df)=name_ind
}
res.mca <- MCA (df, graph = TRUE)
ind <- get_mca_ind (res.mca)
if (name_ind != 1){
fviz_mca_ind(res.mca, select.ind = list(cos2 = 80),col.ind = "contrib",
gradient.cols = c("#00AFBB", "#E7B800", "#FC4E07"),axes=dims,geom="text",
repel = TRUE)
}else{
fviz_mca_ind(res.mca, select.ind = list(cos2 = 80),col.ind = "contrib",
gradient.cols = c("#00AFBB", "#E7B800", "#FC4E07"),axes=dims,geom="point",
repel = TRUE)
}
var <- get_mca_var(res.mca)
corrplot(var$cos2, is.corr=FALSE)
fviz_mca_biplot(res.mca, select.ind = list(cos2 = 75),axes=dims,
repel = TRUE)
}
data = data_0[c(8,14:16,18)]
d=c(1,2)
acm_plot(data,d)
#'
#' @param df
#' @param dims
#' @param name_ind
#'
#' @return
#' @export
#'
#' @examples
#'
acm_plot <- function(df,dims,name_ind=0){
if (name_ind != 0){
rownames(df)=name_ind
}
res.mca <- MCA (df, graph = TRUE)
ind <- get_mca_ind (res.mca)
if (name_ind != 0){
fviz_mca_ind(res.mca, select.ind = list(cos2 = 80),col.ind = "contrib",
gradient.cols = c("#00AFBB", "#E7B800", "#FC4E07"),axes=dims,geom="text",
repel = TRUE)
}else{
fviz_mca_ind(res.mca, select.ind = list(cos2 = 80),col.ind = "contrib",
gradient.cols = c("#00AFBB", "#E7B800", "#FC4E07"),axes=dims,geom="point",
repel = TRUE)
}
var <- get_mca_var(res.mca)
corrplot(var$cos2, is.corr=FALSE)
fviz_mca_biplot(res.mca, select.ind = list(cos2 = 75),axes=dims,
repel = TRUE)
}
data = data_0[c(8,14:16,18)]
d=c(1,2)
acm_plot(data,d)
acm_plot(data,d)
df = data_0[c(8,14:16,18)]
d=c(1,2)
res.mca <- MCA (df, graph = FALSE)
View(df)
View(df)
df = data_0[c(14:16,18)]
d=c(1,2)
res.mca <- MCA (df, graph = FALSE)
acm_plot(data,d)
acm_plot(df,d)
#'
#' @param df
#' @param dims
#' @param name_ind
#'
#' @return
#' @export
#'
#' @examples
#'
acm_plot <- function(df,dims,name_ind=0){
if (name_ind != 0){
rownames(df)=name_ind
}
res.mca <- MCA (df, graph = TRUE)
ind <- get_mca_ind (res.mca)
if (name_ind != 0){
fviz_mca_ind(res.mca, select.ind = list(cos2 = 80),col.ind = "contrib",
gradient.cols = c("#00AFBB", "#E7B800", "#FC4E07"),axes=dims,geom="text",
repel = TRUE)
}else{
fviz_mca_ind(res.mca, select.ind = list(cos2 = 80),col.ind = "contrib",
gradient.cols = c("#00AFBB", "#E7B800", "#FC4E07"),axes=dims,geom="point",
repel = TRUE)
}
var <- get_mca_var(res.mca)
corrplot(var$cos2, is.corr=FALSE)
fviz_mca_biplot(res.mca, select.ind = list(cos2 = 75),axes=dims,
repel = TRUE)
}
df = data_0[c(14:16,18)]
d=c(1,2)
d=c(1,2)
acm_plot(df,d)
acm_plot(df,d)
#'
#' @param df
#' @param dims
#' @param name_ind
#'
#' @return
#' @export
#'
#' @examples
#'
acm_plot <- function(df,dims,name_ind=0){
if (name_ind != 0){
rownames(df)=name_ind
}
res.mca <- MCA (df, graph = FALSE)
ind <- get_mca_ind (res.mca)
if (name_ind != 0){
fviz_mca_ind(res.mca, select.ind = list(cos2 = 80),col.ind = "contrib",
gradient.cols = c("#00AFBB", "#E7B800", "#FC4E07"),axes=dims,geom="text",
repel = TRUE)
}else{
fviz_mca_ind(res.mca, select.ind = list(cos2 = 80),col.ind = "contrib",
gradient.cols = c("#00AFBB", "#E7B800", "#FC4E07"),axes=dims,geom="point",
repel = TRUE)
}
var <- get_mca_var(res.mca)
corrplot(var$cos2, is.corr=FALSE)
fviz_mca_biplot(res.mca, select.ind = list(cos2 = 75),axes=dims,
repel = TRUE)
}
df = data_0[c(14:16,18)]
d=c(1,2)
acm_plot(df,d)
#'
#' @param df
#' @param dims
#' @param name_ind
#'
#' @return
#' @export
#'
#' @examples
#'
acm_plot <- function(df,dims,name_ind=0){
if (name_ind != 0){
rownames(df)=name_ind
}
res.mca <- MCA (df, graph = FALSE)
ind <- get_mca_ind (res.mca)
if (name_ind != 0){
print("cc")
fviz_mca_ind(res.mca, select.ind = list(cos2 = 80),col.ind = "contrib",
gradient.cols = c("#00AFBB", "#E7B800", "#FC4E07"),axes=dims,geom="text",
repel = TRUE)
}else{
print("dd")
fviz_mca_ind(res.mca, select.ind = list(cos2 = 80),col.ind = "contrib",
gradient.cols = c("#00AFBB", "#E7B800", "#FC4E07"),axes=dims,geom="point",
repel = TRUE)
}
var <- get_mca_var(res.mca)
corrplot(var$cos2, is.corr=FALSE)
fviz_mca_biplot(res.mca, select.ind = list(cos2 = 75),axes=dims,
repel = TRUE)
}
df = data_0[c(14:16,18)]
d=c(1,2)
acm_plot(df,d)
#'
#' @param df
#' @param dims
#' @param name_ind
#'
#' @return
#' @export
#'
#' @examples
#'
acm_plot <- function(df,dims,name_ind=0){
if (name_ind != 0){
rownames(df)=name_ind
}
res.mca <- MCA (df, graph = FALSE)
ind <- get_mca_ind (res.mca)
if (name_ind != 0){
print("cc")
fviz_mca_ind(res.mca, select.ind = list(cos2 = 80),col.ind = "contrib",
gradient.cols = c("#00AFBB", "#E7B800", "#FC4E07"),axes=dims,geom="text",
repel = TRUE)
}else{
print("dd")
fviz_mca_ind(res.mca, select.ind = list(cos2 = 80),col.ind = "contrib",
gradient.cols = c("#00AFBB", "#E7B800", "#FC4E07"),axes=dims,geom="point",
repel = TRUE)
}
var <- get_mca_var(res.mca)
corrplot(var$cos2, is.corr=FALSE)
fviz_mca_biplot(res.mca, select.ind = list(cos2 = 75),axes=dims,
repel = TRUE)
}
df = data_0[c(14:16,18)]
d=c(1,2)
acm_plot(df,d)
d=c(3,4)
acm_plot(df,d)
#'
#' @param df
#' @param dims
#' @param name_ind
#'
#' @return
#' @export
#'
#' @examples
#'
acm_plot <- function(df,dims,name_ind=0){
if (name_ind != 0){
rownames(df)=name_ind
}
res.mca <- MCA (df, graph = FALSE)
ind <- get_mca_ind (res.mca)
var <- get_mca_var(res.mca)
corrplot(var$cos2, is.corr=FALSE)
if (name_ind != 0){
print("cc")
fviz_mca_biplot(res.mca, select.ind = list(cos2 = 75),axes=dims,
repel = TRUE,geom=c("text", "text"))
}else{
print("dd")
fviz_mca_biplot(res.mca, select.ind = list(cos2 = 75),axes=dims,
repel = TRUE,geom=c("point", "text"))
}
}
df = data_0[c(14:16,18)]
d=c(3,4)
acm_plot(df,d)
#'
#' @param df
#' @param dims
#' @param name_ind
#'
#' @return
#' @export
#'
#' @examples
#'
acm_plot <- function(df,dims,name_ind=0){
if (name_ind != 0){
rownames(df)=name_ind
}
res.mca <- MCA (df, graph = FALSE)
ind <- get_mca_ind (res.mca)
var <- get_mca_var(res.mca)
corrplot(var$cos2, is.corr=FALSE)
if (name_ind != 0){
print("cc")
fviz_mca_biplot(res.mca, select.ind = list(cos2 = 75),axes=dims,
repel = TRUE,geom=c("text", "text"))
}else{
print("dd")
fviz_mca_biplot(res.mca, select.ind = list(cos2 = 75),axes=dims,
repel = TRUE,geom=c("text", "text"))
}
}
df = data_0[c(14:16,18)]
d=c(3,4)
acm_plot(df,d)
